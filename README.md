# Cnerator


[![License](https://img.shields.io/github/license/ComputationalReflection/cnerator)](LICENSE)
[![Latest release](https://img.shields.io/github/v/release/computationalreflection/cnerator?include_prereleases)](https://github.com/ComputationalReflection/cnerator/releases)
<img alt="Code size" src="https://img.shields.io/github/languages/code-size/computationalreflection/cnerator">
<img alt="Repo size" src="https://img.shields.io/github/repo-size/computationalreflection/cnerator">



Cnerator is a C source code generation tool. It can be used to generate large amounts of 
[standard ANSI/ISO C source code](https://www.iso.org/standard/74528.html), ready to be compiled 
by any standard language implementation. 
Cnerator is highly customizable to generate all the syntactic constructs of the C language, necessary to build 
accurate predictive models with machine learning algorithms. 

## Functionalities

These are the main functionalities provided by Cnerator: 

1. ANSI/ISO standard C. All the source code generated by Cnerator follows the ISO/IEC 9899:2018 (C17) 
standard specification.
 
2. Probabilistic randomness. C language constructs are randomly generated, following different probability 
distributions specified by the user. For example, it is possible to describe the probability of each statement 
and expression construct, the number of statements in a function, and the types of their arguments and return values. 
To this aim, the user can specify fixed probabilities of each element, or use different probability distributions, 
such as normal, uniform and direct and inverse proportional. 

3. Compilable code. The generated code strictly follows the syntax grammar, type system and semantic 
rules of the C programming language. In this way, the generated code has been checked to be compilable 
by any standard compiler implementation. 

4. Highly customizable. Many features of the programs to be generated are customizable. 
Some examples include the types of each language construct, array dimensions and sizes, struct fields, 
maximum depth of expression and statement trees, number of function parameters and statements, 
global and local variables, structures of control flow statements and type promotions, 
among others â€“see the detailed [documentation](documentation). 

5. Large amounts of code. Cnerator is designed to allow generating large amounts of C source code. 
A parameter indicates the number of independent compilation units to be created for the output application, 
so that each unit could be treated as an independently compilable module. This feature, together with the 
probabilistic randomness, make Cnerator an ideal tool to create predictive models of source code, because 
the input programs used to train such models comprise abundant and varied code patterns. 

## Usage

To run Cnerator, you need to install the `singledispatch` Python package first:


``` text
pip intall singledispatch
```

Then, you may just run Cnerator with no arguments to generate a random C program:


``` text
python cnerator.py
```

There are plenty of options to customize Cnerator. To specify the probability of a particular language
construct, you can use the `-p` or `--probs` option. The following command sets to 20% the probability of
generating a function invocation when a new expression is required:

``` text
python cnerator.py -p "call_prob = {True: 0.2, False: 0.8}"
```

If more sophisticated probabilites are required, then you can specify them in a JSON file a pass it as
a parameter (see the [documentation](documentation) to know the JSON file format):

``` text
python cnerator.py -P json/probabilities/example_probs.json
```


To see all the options, just run the `-h` or `--help` options or check the [documentation](documentation).




---


Cnerator is a C source code generation tool. Generated programs can be compiled with any standard ANSI C compiler. 
The user may define different parameters such as the number of function to be generated or the probabilities of all
the different syntactic constructs (e.g., the average number of statements in a function, expression types, 
number and types of local variables, and the kind of syntactic constructs to be generated). 

Generated programs fulfill the type rules of the C programming language, so they are compiled without errors. 
Using the different parameters, the user can utilize Cnerator to create a huge amount of synthetic C programs,
necessary in common "Big Code" scenarios.

## Command line options:

``` text
usage: cnerator.py [-h] [-w PATH] [-o NAME] [-p AMOUNT] [-r RECURSION]
                   [-vst VISITORS] [-v] [-d]

Generates a compilable C program

optional arguments:
  -h, --help            show this help message and exit
  -w PATH, --working-dir PATH
                        Working directory (default: out)
  -o NAME, --output NAME
                        C output file name, without the .c extension (default:
                        main)
  -p AMOUNT, --parts AMOUNT
                        Split the program in different C files (default: 2)
  -r RECURSION, --recursion RECURSION
                        Python recursion limit (default: 50000)
  -vst VISITORS, --visitors VISITORS
                        Semicolon-separated list of visitors, in order (e.g.,
                        visitors.func_to_proc;visitors.return_instrumentation)
                        (default: )
  -v, --verbose         Verbose messages (default: False)
  -d, --debug           Generate debug info (call graph and struct structure)
                        in .dot files (default: False)
```


## License

[BSD 3 clause license](LICENSE)